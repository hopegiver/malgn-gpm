<div>
    <!-- Page Header -->
    <div class="page-header">
        <h1 class="page-title">실행 이력</h1>
        <p class="page-subtitle">월별 업무 실행 현황을 달력으로 확인하세요</p>
    </div>

    <!-- Monthly Stats -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-md-3">
            <div class="stat-card rounded-3 p-4">
                <div class="text-secondary fw-medium mb-2">이번 달 총 업무</div>
                <div class="fw-bold fs-2">{{ monthlyStats.total }}</div>
            </div>
        </div>
        <div class="col-12 col-md-3">
            <div class="stat-card rounded-3 p-4">
                <div class="text-secondary fw-medium mb-2">완료</div>
                <div class="fw-bold text-success fs-2">{{ monthlyStats.completed }}</div>
            </div>
        </div>
        <div class="col-12 col-md-3">
            <div class="stat-card rounded-3 p-4">
                <div class="text-secondary fw-medium mb-2">평균 일일 업무</div>
                <div class="fw-bold text-primary fs-2">{{ monthlyStats.avgDaily }}</div>
            </div>
        </div>
        <div class="col-12 col-md-3">
            <div class="stat-card rounded-3 p-4">
                <div class="text-secondary fw-medium mb-2">완료율</div>
                <div class="fw-bold fs-2">{{ monthlyStats.completionRate }}%</div>
            </div>
        </div>
    </div>

    <!-- Calendar Navigation -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <button class="btn btn-outline-secondary" @click="previousMonth">
            <i class="bi bi-chevron-left"></i> 이전 달
        </button>
        <h4 class="fw-bold mb-0">{{ currentMonthText }}</h4>
        <button class="btn btn-outline-secondary" @click="nextMonth">
            다음 달 <i class="bi bi-chevron-right"></i>
        </button>
    </div>

    <!-- Calendar -->
    <div class="card border-0 shadow-sm rounded-3 mb-4">
        <div class="card-body p-3">
            <!-- Calendar Header (Days of Week) -->
            <div class="row g-2 mb-2">
                <div v-for="day in ['일', '월', '화', '수', '목', '금', '토']" :key="day"
                     class="col text-center fw-bold text-secondary small">
                    {{ day }}
                </div>
            </div>

            <!-- Calendar Grid -->
            <div v-for="(week, weekIndex) in calendarWeeks" :key="weekIndex" class="row g-2 mb-2">
                <div v-for="(day, dayIndex) in week" :key="dayIndex" class="col">
                    <div v-if="day.date" class="p-2 rounded text-center position-relative"
                         :class="getDayClass(day)"
                         @click="selectDay(day)"
                         style="cursor: pointer; min-height: 80px; border: 1px solid var(--gray-200);">
                        <!-- Date -->
                        <div class="fw-bold mb-1" :class="{ 'text-primary': day.isToday }">
                            {{ day.day }}
                        </div>

                        <!-- Task Count -->
                        <div v-if="day.taskCount > 0" class="mb-1">
                            <small class="badge text-xxs" :class="day.completionRate >= 70 ? 'bg-success' : day.completionRate >= 40 ? 'bg-warning' : 'bg-danger'">
                                {{ day.completedCount }}/{{ day.taskCount }}
                            </small>
                        </div>

                        <!-- Completion Indicator -->
                        <div v-if="day.taskCount > 0" class="position-absolute bottom-0 start-0 w-100 progress-xxs"
                             style="background: var(--gray-200);">
                            <div :style="{ width: day.completionRate + '%', height: '100%' }"
                                 :class="day.completionRate >= 70 ? 'bg-success' : day.completionRate >= 40 ? 'bg-warning' : 'bg-danger'"></div>
                        </div>
                    </div>
                    <div v-else class="p-2" style="min-height: 80px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Selected Day Details -->
    <div v-if="selectedDay" class="card border-0 shadow-sm rounded-3">
        <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-bold mb-0">
                    <i class="bi bi-calendar-day"></i> {{ selectedDay.dateText }} 업무 상세
                </h5>
                <button class="btn btn-sm btn-outline-secondary" @click="selectedDay = null">
                    <i class="bi bi-x"></i>
                </button>
            </div>

            <div v-if="selectedDay.tasks.length > 0">
                <div v-for="task in selectedDay.tasks" :key="task.id" class="card mb-2 p-3"
                     :class="{ 'bg-light': task.completed }">
                    <div class="d-flex align-items-start gap-3">
                        <i v-if="task.completed" class="bi bi-check-circle-fill text-success fs-5"></i>
                        <i v-else class="bi bi-circle text-secondary fs-5"></i>
                        <div class="flex-grow-1">
                            <div class="d-flex align-items-center gap-2 mb-1">
                                <span class="fw-medium" :class="{ 'text-decoration-line-through text-secondary': task.completed }">
                                    {{ task.title }}
                                </span>
                                <span v-if="task.priority === 'high'" class="badge bg-danger text-xxs">긴급</span>
                                <span v-else-if="task.priority === 'medium'" class="badge bg-warning text-xxs">보통</span>
                            </div>
                            <div v-if="task.goalTitle" class="text-secondary mb-2" style="font-size: 0.875rem;">
                                <i class="bi bi-bullseye"></i> {{ task.goalTitle }}
                            </div>
                            <div class="text-secondary" style="font-size: 0.875rem;">
                                <i class="bi bi-clock"></i> 예상: {{ task.estimatedTime }}h / 실제: {{ task.actualTime }}h
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div v-else class="text-center py-4 text-secondary">
                이 날짜에는 등록된 업무가 없습니다.
            </div>
        </div>
    </div>
</div>
